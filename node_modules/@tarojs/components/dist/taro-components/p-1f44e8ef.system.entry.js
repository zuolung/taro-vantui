var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;for(var r=Array(e),a=0,t=0;t<i;t++)for(var n=arguments[t],u=0,o=n.length;u<o;u++,a++)r[a]=n[u];return r};System.register(["./p-cf496b3b.system.js","./p-bd00f506.system.js"],(function(e){"use strict";var t,i,r,a,n,u;return{setters:[function(e){t=e.r;i=e.c;r=e.h;a=e.H;n=e.g},function(e){u=e.c}],execute:function(){function o(e,t){var i=[];for(var r=e;r<=t;r++){i.push(""+(r<10?"0":"")+r)}return i}var s=__spreadArrays(["20","21","22","23"],o(0,23),["00","01","02","03"]);var h=__spreadArrays(["56","57","58","59"],o(0,59),["00","01","02","03"]);function l(e,t){if(!isNaN(+e)&&e>=0&&e<t.length)return true;return false}function c(e){if(!/^\d{1,2}:\d{1,2}$/.test(e))return false;var t=e.split(":").map((function(e){return+e}));if(t[0]<0||t[0]>23)return false;if(t[1]<0||t[1]>59)return false;return true}function d(e,t){var i=e.split(":").map((function(e){return+e}));var r=t.split(":").map((function(e){return+e}));if(i[0]<r[0])return true;if(i[0]===r[0]&&i[1]<=r[1])return true;return false}function f(e){if(!e)return false;var t=new Date(e.replace(/-/g,"/"));return isNaN(t.getMonth())?false:t}function p(e,t){if(t===4||t===6||t===9||t===11)return 30;if(t===2){if(e%4===0&&e%100!==0||e%400===0)return 29;else return 28}return 31}function v(e){var t;if(Array.isArray(e)){t=e.map((function(e){return String(e)}))}else{t=e}return t}function g(e,t){var i=[];for(var r=e;r<=t;r++){i.push(r)}return i}function m(e,t){return g(e,t)}function y(e,t,i){var r=1;var a=12;if(e.getFullYear()===i){r=e.getMonth()+1}if(t.getFullYear()===i){a=t.getMonth()+1}return g(r,a)}function k(e,t,i,r){var a=1;var n=p(i,r);if(e.getFullYear()===i&&e.getMonth()+1===r){a=e.getDate()}if(t.getFullYear()===i&&t.getMonth()+1===r){n=t.getDate()}return g(a,n)}var _=102;var w=34;var C=w*7;var D=".weui-picker,.weui-picker__hd{font-size:12px}";var x=e("taro_picker_core",function(){function e(e){var a=this;t(this,e);this.onChange=i(this,"change",7);this.onColumnChange=i(this,"columnchange",7);this.onCancel=i(this,"cancel",7);this.index=[];this.mode="selector";this.disabled=false;this.range=[];this.start="";this.end="";this.fields="day";this.name="";this.pickerValue=[];this.height=[];this.hidden=true;this.fadeOut=false;this.isWillLoadCalled=false;this.showPicker=function(){if(a.disabled)return;a.height=a.getHeightByIndex();a.hidden=false};this.getHeightByIndex=function(){var e=a.index.map((function(e){var t=0;if(a.mode==="time"){t=w*4}return _-w*e-t}));return e};this.hidePicker=function(){a.fadeOut=true;setTimeout((function(){a.hidden=true;a.fadeOut=false}),350)};this.handleChange=function(){a.hidePicker();a.index=a.height.map((function(e){return(_-e)/w}));var e=a.index.length&&a.mode!=="selector"?a.index:a.index[0];if(a.mode==="time"){var t=[s.slice(),h.slice()];var i=a.index.map((function(e,i){return t[i][e]}));a.index=i.map((function(e){return parseInt(e)}));e=i.join(":")}if(a.mode==="date"){var r=a.pickerDate,n=r._start,u=r._end,o=r._updateValue;var l=o[0];var c=o[1];var d=m(n.getFullYear(),u.getFullYear());var f=y(n,u,l);var p=k(n,u,l,c);var v=d[a.index[0]];var g=f[a.index[1]];var C=p[a.index[2]];if(a.fields==="year"){e=[v]}else if(a.fields==="month"){e=[v,g]}else{e=[v,g,C]}e=e.map((function(e){return e<10?"0"+e:e})).join("-")}a.pickerValue=e;a.onChange.emit({value:e})};this.handleCancel=function(){a.hidePicker();a.onCancel.emit()};this.updateHeight=function(e,t,i){if(i===void 0){i=false}var r=__spreadArrays(a.height);r[t]=e;a.height=r;if(i){var n=a,u=n.start,o=n.end;if(!c(u))u="00:00";if(!c(o))o="23:59";if(!d(u,o))return;var l=[s.slice(),h.slice()];var f=a.height.map((function(e){return(_-e)/w}));var p=f.map((function(e,t){return l[t][e]})).join(":");if(!d(u,p)){var v=u.split(":").map((function(e){return _-w*(+e+4)}));requestAnimationFrame((function(){return a.height=v}))}else if(!d(p,o)){var g=o.split(":").map((function(e){return _-w*(+e+4)}));requestAnimationFrame((function(){return a.height=g}))}}};this.handleColumnChange=function(e,t){a.onColumnChange.emit({column:Number(t),value:(_-e)/w})};this.updateDay=function(e,t){var i=a.pickerDate,r=i._start,n=i._end,u=i._updateValue;u[t]=e;var o=u[0];var s=u[1];var h=u[2];if(t===0){var l=y(r,n,o);var c=l[l.length-1];var d=l[0];if(s>c)u[1]=c;if(s<d)u[1]=d;var f=l.indexOf(u[1]);var p=_-w*f;a.updateDay(u[1],1);a.updateHeight(p,"1")}else if(t===1){var v=k(r,n,o,s);var c=v[v.length-1];var d=v[0];if(h>c)u[2]=c;if(h<d)u[2]=d;var f=v.indexOf(u[2]);var p=_-w*f;a.updateDay(u[2],2);a.updateHeight(p,"2")}};this.getSelector=function(){return r("taro-picker-group",{range:a.range,rangeKey:a.rangeKey,height:a.height[0],updateHeight:a.updateHeight,columnId:"0"})};this.getMultiSelector=function(){return a.range.map((function(e,t){return r("taro-picker-group",{range:e,rangeKey:a.rangeKey,height:a.height[t],updateHeight:a.updateHeight,onColumnChange:a.handleColumnChange,columnId:String(t)})}))};this.getTimeSelector=function(){var e=s.slice();var t=h.slice();return[r("taro-picker-group",{mode:"time",range:e,height:a.height[0],updateHeight:a.updateHeight,columnId:"0"}),r("taro-picker-group",{mode:"time",range:t,height:a.height[1],updateHeight:a.updateHeight,columnId:"1"})]};this.getDateSelector=function(){var e=a,t=e.fields,i=e.height;var n=a.pickerDate,u=n._start,o=n._end,s=n._updateValue;var h=s[0];var l=s[1];var c=m(u.getFullYear(),o.getFullYear()).map((function(e){return e+"年"}));var d=y(u,o,h).map((function(e){return(e<10?"0"+e:e)+"月"}));var f=k(u,o,h,l).map((function(e){return(e<10?"0"+e:e)+"日"}));var p=[r("taro-picker-group",{mode:"date",range:c,height:i[0],updateDay:a.updateDay,updateHeight:a.updateHeight,columnId:"0"})];if(t==="month"||t==="day"){p.push(r("taro-picker-group",{mode:"date",range:d,height:i[1],updateDay:a.updateDay,updateHeight:a.updateHeight,columnId:"1"}))}if(t==="day"){p.push(r("taro-picker-group",{mode:"date",range:f,height:i[2],updateDay:a.updateDay,updateHeight:a.updateHeight,columnId:"2"}))}return p}}e.prototype.componentWillLoad=function(){this.isWillLoadCalled=true;this.handleProps()};e.prototype.componentDidLoad=function(){var e=this;Object.defineProperty(this.el,"value",{get:function(){return e.pickerValue},set:function(t){return e.value=t},configurable:true});if(this.overlay){document.body.appendChild(this.overlay)}};e.prototype.disconnectedCallback=function(){var e;if(this.overlay){(e=this.overlay.parentNode)===null||e===void 0?void 0:e.removeChild(this.overlay)}};e.prototype.onPropsChange=function(){if(!this.isWillLoadCalled)return;this.handleProps()};e.prototype.handleProps=function(){var e=this;var t=this,i=t.mode,r=t.start,a=t.end;if(i==="selector"){var n=this.value;this.index=[l(n,this.range)?Math.floor(n):0]}else if(i==="multiSelector"){var u=this.value;this.index=[];this.range.forEach((function(t,i){var r=u===null||u===void 0?void 0:u[i];var a=l(r,t)?Math.floor(r):0;e.index.push(a)}))}else if(i==="time"){var n=this.value;if(!c(n)){console.warn("time picker value illegal");n="0:0"}var o=n.split(":").map((function(e){return+e}));this.index=o}else if(i==="date"){var n=this.value;var s=f(n)||new Date((new Date).setHours(0,0,0,0));var h=f(r)||new Date("1970/01/01");var d=f(a)||new Date("2999/01/01");if(s>=h&&s<=d){var p=s.getFullYear();var v=s.getMonth()+1;var g=s.getDate();var _=m(h.getFullYear(),d.getFullYear());var w=y(h,d,p);var C=k(h,d,p,v);this.index=[_.indexOf(p),w.indexOf(v),C.indexOf(g)];if(!this.pickerDate||this.pickerDate._value.getTime()!==s.getTime()||this.pickerDate._start.getTime()!==h.getTime()||this.pickerDate._end.getTime()!==d.getTime()){this.pickerDate={_value:s,_start:h,_end:d,_updateValue:[p,v,g]}}}else{throw new Error("Date Interval Error")}}this.height=this.getHeightByIndex();this.pickerValue=this.value;if(i==="date"){var D=this.pickerValue;if(this.fields==="month"){this.pickerValue=D.split("-").slice(0,2).join("-")}else if(this.fields==="year"){this.pickerValue=D.split("-")[0]}}};e.prototype.render=function(){var e=this;var t=this,i=t.name,n=t.mode,o=t.fadeOut,s=t.hidden;var h;switch(n){case"multiSelector":h=this.getMultiSelector();break;case"time":h=this.getTimeSelector();break;case"date":h=this.getDateSelector();break;default:h=this.getSelector()}var l=u("weui-mask","weui-animate-fade-in",{"weui-animate-fade-out":o});var c=u("weui-picker","weui-animate-slide-up",{"weui-animate-slide-down":o});var d=s?{display:"none"}:{};return r(a,null,r("div",{onClick:this.showPicker},r("slot",null),r("input",{type:"hidden",name:i,value:v(this.pickerValue)})),r("div",{class:"weui-picker__overlay",style:d,ref:function(t){e.overlay=t}},r("div",{class:l,onClick:this.handleCancel}),r("div",{class:c},r("div",{class:"weui-picker__hd"},r("div",{class:"weui-picker__action",onClick:this.handleCancel},"取消"),r("div",{class:"weui-picker__action",onClick:this.handleChange},"确定")),r("div",{class:"weui-picker__bd"},h),r("input",{type:"hidden",name:i,value:v(this.pickerValue)}))))};Object.defineProperty(e.prototype,"el",{get:function(){return n(this)},enumerable:false,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{mode:["onPropsChange"],value:["onPropsChange"],range:["onPropsChange"],start:["onPropsChange"],end:["onPropsChange"]}},enumerable:false,configurable:true});return e}());x.style=D;var H=e("taro_picker_group",function(){function e(e){t(this,e);this.range=[]}e.prototype.getPosition=function(){var e=this.touchEnd?.3:0;var t="translate3d(0, "+this.height+"px, 0)";var i="transform "+e+"s";return{transform:t,"-webkit-transform":t,transition:i,"-webkit-transition":i}};e.prototype.formulaUnlimitedScroll=function(e,t,i){var r=this;var a=this,n=a.height,u=a.updateHeight,o=a.columnId;var s=i==="up"?1:-1;this.touchEnd=false;u(-e*s*w+n,o);requestAnimationFrame((function(){r.touchEnd=true;var i=Math.round(t/-w)+e*s;var a=_-w*i;u(a,o,true)}))};e.prototype.onTouchStart=function(e){this.startY=e.changedTouches[0].clientY;this.preY=e.changedTouches[0].clientY;this.hadMove=false};e.prototype.onTouchMove=function(e){e.preventDefault();var t=e.changedTouches[0].clientY;var i=t-this.preY;this.preY=t;this.touchEnd=false;if(Math.abs(t-this.startY)>10)this.hadMove=true;var r=this.height+i;if(this.mode==="time"){if(this.columnId==="0"){if(r>_-w*3){r=_-w*27+i}if(r<_-w*28){r=_-w*4+i}}else if(this.columnId==="1"){if(r>_-w*3){r=_-w*63+i}if(r<_-w*64){r=_-w*4+i}}}this.updateHeight(r,this.columnId)};e.prototype.onTouchEnd=function(e){var t=this,i=t.mode,r=t.range,a=t.height,n=t.updateHeight,u=t.onColumnChange,o=t.columnId;var s=0;var h=-w*(r.length-1);var l=e.changedTouches[0].clientY;this.touchEnd=true;var c;if(!this.hadMove){var d=window.innerHeight;var f=d-C/2;c=a-_-(l-f);if(i==="time"){if(o==="0"){if(c>-w*2.5){return this.formulaUnlimitedScroll(24,c,"up")}if(c<-w*28.5){return this.formulaUnlimitedScroll(24,c,"down")}}else if(o==="1"){if(c>-w*2.5){return this.formulaUnlimitedScroll(60,c,"up")}if(c<-w*64.5){return this.formulaUnlimitedScroll(60,c,"down")}}}}else{c=a-_}if(c>s)c=0;if(c<h)c=h;var p=Math.round(c/-w);var v=_-w*p;if(this.mode==="date"){if(this.columnId==="0"){this.updateDay(+this.range[p].replace(/[^0-9]/gi,""),0)}if(this.columnId==="1"){this.updateDay(+this.range[p].replace(/[^0-9]/gi,""),1)}if(this.columnId==="2"){this.updateDay(+this.range[p].replace(/[^0-9]/gi,""),2)}}n(v,o,i==="time");u&&u(v,o)};e.prototype.render=function(){var e=this,t=e.range,i=e.rangeKey;var n=t.map((function(e){var t=i?e[i]:e;return r("div",{class:"weui-picker__item"},t)}));return r(a,{class:"weui-picker__group"},r("div",{class:"weui-picker__mask"}),r("div",{class:"weui-picker__indicator"}),r("div",{class:"weui-picker__content",style:this.getPosition()},n))};return e}())}}}));